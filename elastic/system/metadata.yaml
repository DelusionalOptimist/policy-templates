version: v0.2.3
policyRules:
- name: elasticsearch-indices-dir
  precondition: 
  - /usr/share/elasticsearch/data/nodes/0/indices/
  description:
    refs:
    - name: ELASTIC SEARCH INDICES INSECURE 
      url:
      - https://www.elastic.co/guide/en/elasticsearch/reference/current/security-settings.html
    tldr: Elastic search indices directory contains vulnerable and insecure information
    detailed: Elastic directory contains insecure information that leads to security vulnerability. 
  yaml: ksp-audit-elasticsearch-indices.yaml
- name: elasticsearch-log-files
  precondition:
  - /var/log/elasticsearch/
  description:
    refs:
    - name: ELASTIC SEARCH LOG FILE ACCESS
      url:
      - https://www.elastic.co/guide/en/workplace-search/current/workplace-search-permissions.html
    tldr: Auditing the elastic search log file access from exposing
    detailed: Elasticsearch log files are stored in logs directory and It should not be exposed to the public
      and most of the logs are stored in "/var/log/elasticsearch/".
  yaml: ksp-audit-elasticsearch-log-file-access.yaml